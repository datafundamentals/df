<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Component Playground - Standalone Testing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light">

  <!-- Material Design 3 Theming -->
  <style>
    /* Material Design 3 Color Tokens */
    :root {
      --md-sys-color-primary: #6750a4;
      --md-sys-color-on-primary: #ffffff;
      --md-sys-color-primary-container: #eaddff;
      --md-sys-color-on-primary-container: #21005d;
      --md-sys-color-secondary: #625b71;
      --md-sys-color-on-secondary: #ffffff;
      --md-sys-color-secondary-container: #e8def8;
      --md-sys-color-on-secondary-container: #1d192b;
      --md-sys-color-tertiary: #7d5260;
      --md-sys-color-on-tertiary: #ffffff;
      --md-sys-color-tertiary-container: #ffd8e4;
      --md-sys-color-on-tertiary-container: #31111d;
      --md-sys-color-error: #ba1a1a;
      --md-sys-color-on-error: #ffffff;
      --md-sys-color-error-container: #ffdad6;
      --md-sys-color-on-error-container: #410002;
      --md-sys-color-background: #fffbfe;
      --md-sys-color-on-background: #1c1b1f;
      --md-sys-color-surface: #fffbfe;
      --md-sys-color-on-surface: #1c1b1f;
      --md-sys-color-surface-variant: #e7e0ec;
      --md-sys-color-on-surface-variant: #49454f;
      --md-sys-color-outline: #79747e;
      --md-sys-color-outline-variant: #cac4d0;
      --md-sys-color-shadow: #000000;
      --md-sys-color-scrim: #000000;
      --md-sys-color-surface-tint: #6750a4;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: var(--md-sys-color-background);
      color: var(--md-sys-color-on-background);
      line-height: 1.6;
    }

    .playground-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .playground-header {
      text-align: center;
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--md-sys-color-outline-variant);
    }

    .playground-header h1 {
      color: var(--md-sys-color-primary);
      margin-bottom: 8px;
    }

    .playground-header p {
      color: var(--md-sys-color-on-surface-variant);
      font-size: 16px;
    }

    .test-section {
      margin-bottom: 48px;
      padding: 24px;
      border: 1px solid var(--md-sys-color-outline-variant);
      border-radius: 16px;
      background-color: var(--md-sys-color-surface);
    }

    .test-section h2 {
      color: var(--md-sys-color-on-surface);
      margin-top: 0;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .test-section .description {
      color: var(--md-sys-color-on-surface-variant);
      font-style: italic;
      margin-bottom: 20px;
      padding: 12px;
      background-color: var(--md-sys-color-primary-container);
      border-radius: 8px;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: var(--md-sys-color-outline);
    }

    .status-indicator.success {
      background-color: var(--md-sys-color-tertiary);
    }

    .status-indicator.error {
      background-color: var(--md-sys-color-error);
    }

    .component-container {
      border: 1px dashed var(--md-sys-color-outline-variant);
      border-radius: 8px;
      padding: 16px;
      margin: 16px 0;
      background-color: var(--md-sys-color-surface-variant);
      min-height: 100px;
    }

    .event-log {
      background-color: var(--md-sys-color-secondary-container);
      border: 1px solid var(--md-sys-color-outline-variant);
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
      max-height: 200px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 12px;
    }

    .event-log-entry {
      margin-bottom: 4px;
      color: var(--md-sys-color-on-secondary-container);
    }

    .controls {
      margin-bottom: 16px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    button {
      padding: 8px 16px;
      border: 1px solid var(--md-sys-color-outline);
      border-radius: 8px;
      background-color: var(--md-sys-color-primary-container);
      color: var(--md-sys-color-on-primary-container);
      cursor: pointer;
      font-family: inherit;
    }

    button:hover {
      background-color: var(--md-sys-color-primary);
      color: var(--md-sys-color-on-primary);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Component-specific styling */
    .mock-navigation {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin: 16px 0;
    }

    .mock-navigation button {
      font-size: 12px;
      padding: 4px 12px;
    }

    .success { color: var(--md-sys-color-tertiary); }
    .error { color: var(--md-sys-color-error); }
  </style>
</head>

<body>
  <div class="playground-container">
    <div class="playground-header">
      <h1>ðŸ§ª Component Playground - Standalone</h1>
      <p>Simplified testing environment for extracted RAG components</p>
      <p><strong>Purpose:</strong> Validate component rendering and basic event handling without external dependencies</p>
    </div>

    <!-- BASIC COMPONENT LOADING -->
    <div class="test-section">
      <h2><span class="status-indicator" id="loading-status"></span> Component Loading Tests</h2>
      <div class="description">
        <strong>Goal:</strong> Verify all extracted components load without errors<br>
        <strong>Method:</strong> Create component instances and check for console errors
      </div>
      
      <div class="controls">
        <button onclick="testComponentLoading()">Test Component Loading</button>
        <button onclick="clearLog('loading')">Clear Log</button>
      </div>

      <div class="component-container" id="loading-container">
        <p>Click "Test Component Loading" to verify components load correctly</p>
      </div>

      <div class="event-log" id="loading-log">
        <div class="event-log-entry">Ready to test component loading...</div>
      </div>
    </div>

    <!-- BASIC EVENT COMMUNICATION -->
    <div class="test-section">
      <h2><span class="status-indicator" id="events-status"></span> Event Communication Tests</h2>
      <div class="description">
        <strong>Goal:</strong> Verify custom events fire correctly<br>
        <strong>Method:</strong> Trigger events and capture them with listeners
      </div>
      
      <div class="controls">
        <button onclick="testBasicEvents()">Test Basic Events</button>
        <button onclick="clearLog('events')">Clear Log</button>
      </div>

      <div class="component-container" id="events-container">
        <p>Click "Test Basic Events" to verify event communication</p>
      </div>

      <div class="event-log" id="events-log">
        <div class="event-log-entry">Ready to test event communication...</div>
      </div>
    </div>

    <!-- VISUAL COMPONENT DISPLAY -->
    <div class="test-section">
      <h2><span class="status-indicator" id="visual-status"></span> Visual Component Display</h2>
      <div class="description">
        <strong>Goal:</strong> Verify components render with basic styling<br>
        <strong>Method:</strong> Display components with mock props and verify appearance
      </div>
      
      <div class="controls">
        <button onclick="testVisualDisplay()">Test Visual Display</button>
        <button onclick="clearLog('visual')">Clear Log</button>
      </div>

      <div class="component-container" id="visual-container">
        <p>Click "Test Visual Display" to see component rendering</p>
      </div>

      <div class="event-log" id="visual-log">
        <div class="event-log-entry">Ready to test visual display...</div>
      </div>
    </div>
  </div>

  <!-- Component imports - only the basic ones we can test without dependencies -->
  <script type="module" src="../out-tsc/ui/context-slider.js"></script>
  <script type="module" src="../out-tsc/ui/query-form.js"></script>
  <script type="module" src="../out-tsc/ui/document-metadata.js"></script>
  <script type="module" src="../out-tsc/ui/relevance-group.js"></script>

  <script>
    // Utility functions
    function logMessage(section, message, isError = false) {
      const logElement = document.getElementById(`${section}-log`);
      if (logElement) {
        const timestamp = new Date().toISOString().split('T')[1].split('.')[0];
        const entry = document.createElement('div');
        entry.className = `event-log-entry ${isError ? 'error' : 'success'}`;
        entry.textContent = `[${timestamp}] ${message}`;
        
        logElement.appendChild(entry);
        logElement.scrollTop = logElement.scrollHeight;
      }
    }

    function updateStatus(section, status) {
      const indicator = document.getElementById(`${section}-status`);
      if (indicator) {
        indicator.className = `status-indicator ${status}`;
      }
    }

    function clearLog(section) {
      const logElement = document.getElementById(`${section}-log`);
      if (logElement) {
        logElement.innerHTML = '<div class="event-log-entry">Log cleared</div>';
      }
      updateStatus(section, '');
    }

    // Test functions
    function testComponentLoading() {
      const container = document.getElementById('loading-container');
      container.innerHTML = '<p>Testing component loading...</p>';
      
      let successCount = 0;
      let totalTests = 0;

      // Test Context Slider
      try {
        totalTests++;
        const contextSlider = document.createElement('context-slider');
        contextSlider.setAttribute('value', '5');
        contextSlider.setAttribute('min', '-10');
        contextSlider.setAttribute('max', '50');
        container.appendChild(contextSlider);
        
        logMessage('loading', 'âœ“ context-slider component created');
        successCount++;
      } catch (error) {
        logMessage('loading', `âœ— context-slider failed: ${error.message}`, true);
      }

      // Test Query Form
      try {
        totalTests++;
        const queryForm = document.createElement('query-form');
        queryForm.setAttribute('queryText', 'Test query');
        queryForm.setAttribute('contextValue', '5');
        container.appendChild(queryForm);
        
        logMessage('loading', 'âœ“ query-form component created');
        successCount++;
      } catch (error) {
        logMessage('loading', `âœ— query-form failed: ${error.message}`, true);
      }

      // Test Document Metadata
      try {
        totalTests++;
        const docMetadata = document.createElement('document-metadata');
        docMetadata.metadata = {
          title: 'Test Document',
          tags: 'test, playground',
          category: 'primary'
        };
        container.appendChild(docMetadata);
        
        logMessage('loading', 'âœ“ document-metadata component created');
        successCount++;
      } catch (error) {
        logMessage('loading', `âœ— document-metadata failed: ${error.message}`, true);
      }

      // Update status
      if (successCount === totalTests) {
        updateStatus('loading', 'success');
        logMessage('loading', `All ${totalTests} components loaded successfully!`);
      } else {
        updateStatus('loading', 'error');
        logMessage('loading', `${successCount}/${totalTests} components loaded`, true);
      }
    }

    function testBasicEvents() {
      const container = document.getElementById('events-container');
      container.innerHTML = '<p>Testing event communication...</p>';
      
      let eventCount = 0;

      // Test Context Slider Events
      try {
        const contextSlider = document.createElement('context-slider');
        contextSlider.addEventListener('value-changed', (event) => {
          eventCount++;
          logMessage('events', `âœ“ context-slider value-changed: ${event.detail.value}`);
        });
        
        container.appendChild(contextSlider);
        
        // Simulate value change
        const changeEvent = new CustomEvent('value-changed', {
          detail: { value: 10 },
          bubbles: true
        });
        contextSlider.dispatchEvent(changeEvent);
        
      } catch (error) {
        logMessage('events', `âœ— context-slider event test failed: ${error.message}`, true);
      }

      // Test Query Form Events
      try {
        const queryForm = document.createElement('query-form');
        queryForm.addEventListener('query-submit', (event) => {
          eventCount++;
          logMessage('events', `âœ“ query-form query-submit: "${event.detail.queryText}"`);
        });
        
        container.appendChild(queryForm);
        
        // Simulate form submission
        const submitEvent = new CustomEvent('query-submit', {
          detail: { queryText: 'Test query from playground', contextValue: 5 },
          bubbles: true
        });
        queryForm.dispatchEvent(submitEvent);
        
      } catch (error) {
        logMessage('events', `âœ— query-form event test failed: ${error.message}`, true);
      }

      // Check results
      setTimeout(() => {
        if (eventCount >= 2) {
          updateStatus('events', 'success');
          logMessage('events', `Event communication working! Captured ${eventCount} events`);
        } else {
          updateStatus('events', 'error');
          logMessage('events', `Only captured ${eventCount} events, expected 2+`, true);
        }
      }, 100);
    }

    function testVisualDisplay() {
      const container = document.getElementById('visual-container');
      container.innerHTML = '<h4>Visual Component Display Test</h4>';
      
      // Create a context slider with visible styling
      const contextSlider = document.createElement('context-slider');
      contextSlider.setAttribute('value', '15');
      contextSlider.setAttribute('min', '-10');
      contextSlider.setAttribute('max', '50');
      contextSlider.style.marginBottom = '20px';
      
      // Create document metadata display
      const docMetadata = document.createElement('document-metadata');
      docMetadata.metadata = {
        title: 'React Performance Optimization',
        tags: 'react, performance, optimization',
        category: 'primary',
        isA: 'technical guide',
        childOf: 'frontend development'
      };
      docMetadata.style.marginBottom = '20px';
      
      container.appendChild(contextSlider);
      container.appendChild(docMetadata);
      
      logMessage('visual', 'âœ“ Context slider displayed');
      logMessage('visual', 'âœ“ Document metadata displayed');
      logMessage('visual', 'Visual components rendered successfully');
      updateStatus('visual', 'success');
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
      logMessage('loading', 'Component playground initialized');
      logMessage('events', 'Event testing system ready');
      logMessage('visual', 'Visual testing system ready');
      console.log('ðŸ§ª Standalone Component Playground loaded successfully!');
    });
  </script>
</body>
</html>