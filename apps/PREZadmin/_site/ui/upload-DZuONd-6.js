import{q as a,j as s,v as o,k as t,w as e,y as r,z as n,a as i,d as l,c,A as d}from"./auth-C1lDTTv0.js";const u=a(null),w=a(0),f=async a=>{const f=u.get();if(!f||!s)throw new Error("No file to upload or user is not logged in.");return new Promise((s,u)=>{const g=o(e,`uploads/${t.get()?.uid}/${a}/${f.name}`),p=r(g,f);p.on("state_changed",a=>{const s=a.bytesTransferred/a.totalBytes;w.set(1==s?0:s+.1)},a=>{console.error("Upload failed:",a),u(a)},async()=>{try{const o=await n(p.snapshot.ref),e=await i(l,"uploads",t.get()?.uid),r=c(e,a);await r.firestore;const u=await i(r,f.name),w={link:o};await d(u,w),s(o)}catch(a){console.error("Failed to get download URL:",a),u(a)}})})};export{w as a,u as f,f as u};
